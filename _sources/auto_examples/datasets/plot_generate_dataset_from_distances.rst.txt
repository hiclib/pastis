
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/datasets/plot_generate_dataset_from_distances.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_datasets_plot_generate_dataset_from_distances.py>`
        to download the full example code or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_datasets_plot_generate_dataset_from_distances.py:


Generate a random dataset from a distance matrix
================================================

This example showcases how to generated a random dataset from a distance
matrix using different probability distribution.

.. GENERATED FROM PYTHON SOURCE LINES 8-19

.. code-block:: default


    import numpy as np
    import matplotlib.pyplot as plt
    from matplotlib import colors

    from sklearn.metrics import euclidean_distances

    from pastis.datasets import generate_dataset_from_distances
    from pastis.optimization.mds import estimate_X
    import iced








.. GENERATED FROM PYTHON SOURCE LINES 20-21

Generate a 3DÂ structure from a toy dataset

.. GENERATED FROM PYTHON SOURCE LINES 21-29

.. code-block:: default

    counts, lengths = iced.datasets.load_sample_yeast()
    counts = iced.filter.filter_low_counts(counts, remove_all_zeros_loci=True,
                                           sparsity=False)
    counts = iced.normalization.ICE_normalization(counts)
    structure = estimate_X(counts)
    distances = euclidean_distances(structure, structure)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /usr/share/miniconda3/envs/pastis/lib/python3.9/site-packages/iced/io/_io_pandas.py:56: UserWarning: Attempting to guess whether counts are 0 or 1 based
      warnings.warn(




.. GENERATED FROM PYTHON SOURCE LINES 30-31

Now, generate the contact count matrix from the distance matrix

.. GENERATED FROM PYTHON SOURCE LINES 31-37

.. code-block:: default

    negative_binomial_count = generate_dataset_from_distances(
        distances, alpha=-3, distribution="NegativeBinomial")
    poisson_count = generate_dataset_from_distances(
        distances, alpha=-3, distribution="Poisson", lengths=lengths,
        alpha_inter=-2)








.. GENERATED FROM PYTHON SOURCE LINES 38-39

Plot the resulting contact count matrices

.. GENERATED FROM PYTHON SOURCE LINES 39-71

.. code-block:: default

    fig, axes = plt.subplots(figsize=(7, 7),
                             ncols=2, nrows=2, tight_layout=True)


    def plot_matrix(ax, matrix, cmap="RdBu_r", norm=None, lengths=None):
        if lengths is None:
            lengths = np.array([matrix.shape[0]])
        ax.matshow(matrix, cmap=cmap, norm=norm,
                   extent=(0, lengths.sum(), 0, lengths.sum()))
        [ax.axhline(i, linewidth=1, color="#000000") for i in lengths.cumsum()]
        [ax.axvline(i, linewidth=1, color="#000000") for i in lengths.cumsum()]
        ax.set_xticks([])
        ax.set_yticks([])


    # First, plot the original contact count matrix
    plot_matrix(axes[0, 0], counts, norm=colors.SymLogNorm(1), lengths=lengths)
    axes[0, 0].set_title("Contact counts", fontweight="bold")

    # Plot the distance matrix used as input to the generated data function
    plot_matrix(axes[0, 1], distances, cmap="viridis", lengths=lengths)
    axes[0, 1].set_title("Distance matrix", fontweight="bold")

    # The negative binomial counts
    plot_matrix(axes[1, 0], negative_binomial_count, norm=colors.SymLogNorm(1),
                lengths=lengths)
    axes[1, 0].set_title("Simulated dataset (NB)", fontweight="bold")

    # The Poisson dataset
    plot_matrix(axes[1, 1], poisson_count, norm=colors.SymLogNorm(1),
                lengths=lengths)
    axes[1, 1].set_title("Simulated dataset (Poisson)", fontweight="bold")



.. image:: /auto_examples/datasets/images/sphx_glr_plot_generate_dataset_from_distances_001.png
    :alt: Contact counts, Distance matrix, Simulated dataset (NB), Simulated dataset (Poisson)
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/runner/work/pastis/pastis/examples/datasets/plot_generate_dataset_from_distances.py:55: MatplotlibDeprecationWarning: default base will change from np.e to 10 in 3.4.  To suppress this warning specify the base keyword argument.
      plot_matrix(axes[0, 0], counts, norm=colors.SymLogNorm(1), lengths=lengths)
    /home/runner/work/pastis/pastis/examples/datasets/plot_generate_dataset_from_distances.py:63: MatplotlibDeprecationWarning: default base will change from np.e to 10 in 3.4.  To suppress this warning specify the base keyword argument.
      plot_matrix(axes[1, 0], negative_binomial_count, norm=colors.SymLogNorm(1),
    /home/runner/work/pastis/pastis/examples/datasets/plot_generate_dataset_from_distances.py:68: MatplotlibDeprecationWarning: default base will change from np.e to 10 in 3.4.  To suppress this warning specify the base keyword argument.
      plot_matrix(axes[1, 1], poisson_count, norm=colors.SymLogNorm(1),

    Text(0.5, 1.0, 'Simulated dataset (Poisson)')




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  1.667 seconds)


.. _sphx_glr_download_auto_examples_datasets_plot_generate_dataset_from_distances.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example


  .. container:: binder-badge

    .. image:: images/binder_badge_logo.svg
      :target: https://mybinder.org/v2/gh/hiclib/pastis/gh-pages?urlpath=lab/tree/notebooks/auto_examples/datasets/plot_generate_dataset_from_distances.ipynb
      :alt: Launch binder
      :width: 150 px


  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_generate_dataset_from_distances.py <plot_generate_dataset_from_distances.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_generate_dataset_from_distances.ipynb <plot_generate_dataset_from_distances.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
